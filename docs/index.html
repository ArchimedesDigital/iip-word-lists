<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Word List</title>
<link rel="stylesheet" type="text/css" href="wordlist.css">
</head>
<body>
	<div id="controls">
	Sort by 
	<select id="sort1"> 
		<option value="1">Language</option>
		<option value="3">File</option>		
		<option value="0">Alphabetical</option>	
	</select> 
	then by
	<select id="sort2"> 
		<option value="0">Alphabetical</option>		
		<option value="1">Language</option>
		<option value="3">File</option>	
	</select>
	and display from <input type="number" id="startIndex" value="0"/> to <input type="number" id="endIndex" value="1000" /> <button onclick="reorderData()"> Sort </button>
	</div>	
	<table id="data"><tr><th>Word</th><th>Language</th><th>Edition</th><th>File</th></tr></table>
	<script>
		let sortOrder = [1, 0, 3, 2];
		let wordList = null;
		function displayData(wordList, start, end) {
			let rows = wordList.split("\n");
			
			rows.sort(function (a, b) {
				let columnsA = a.split(",");
				let columnsB = b.split(",");
				for (let i = 0; i < sortOrder.length; i++) {
					if (columnsA[sortOrder[i]] > columnsB[sortOrder[i]]) {
						return 1;
					} else if (columnsB[sortOrder[i]] > columnsA[sortOrder[i]]) {
						return -1;
					}
				}
				return 0;
			});			
			
			let dataTable = document.getElementById('data');
			while(dataTable.childNodes.length > 1) {
				dataTable.removeChild(dataTable.lastChild);
			}			
			
			for (let i = start; i < end; i++) {
				let newRow = document.createElement("tr");
				let newRowData = rows[i].split(",");
				for (let j = 0; j < newRowData.length; j++) {
					let newColumn = document.createElement("td");
					newColumn.innerHTML = newRowData[j];
					newRow.appendChild(newColumn);				
				}
				if (newRow.childNodes.length > 1) {
					dataTable.appendChild(newRow);
				}
			}
		}
		function getData(url) {
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == XMLHttpRequest.DONE) {   // XMLHttpRequest.DONE == 4
					if (xmlhttp.status == 200) {
						wordList = xmlhttp.responseText;
						displayData(wordList, 0, 1000);
					}
					else if (xmlhttp.status == 400) {
						alert('There was an error 400');
					}
					else {
						alert('something else other than 200 was returned');
					}
				}
			};
			xmlhttp.open("GET", url, true);
			xmlhttp.send();
		}
		
		function reorderData() {
			sortOrder = [parseInt(document.getElementById("sort1").value), parseInt(document.getElementById("sort2").value)];
			displayData(wordList, document.getElementById("startIndex").value, document.getElementById("endIndex").value); 
		}		
		
		getData("wordlist.csv");
		
	</script>
</body>
</html>